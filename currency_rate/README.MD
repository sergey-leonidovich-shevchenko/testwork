# Currency Rate

Нужно прочитать наше стандартное тестовое задание, реализовать, также составить документацию.

Предположим, что уже есть команда Symfony, которая должна обновлять курсы раз в сутки, и есть controller action, который принимает request в каком-то виде, и в каком-то виде отдаёт response.
Как бы вы реализовали описанную функциональность, как бы хранили данные, какие классы бы использовали (repositories, services, DTO, value objects etc.), и как бы их назвали.

## Задача

1. Создайте репозитарий (на ГитХабе, например, или БитБакете), в который будете складывать код.
2. Используя экспорт из двух источников реализуйте сбор данных о курсах валют на текущую дату посредством консольной команды
    - https://www.ecb.europa.eu/stats/eurofxref/eurofxref-daily.xml
    - https://www.cbr.ru/scripts/XML_daily.asp
3. Все данные нужно записать в БД используя ORM Doctrine.
4. Сделать конфигурацию в проекте для переключения источника данных (ECB или CBR). Уметь рассчитывать сумму для обмена между валютами, которые не являются базовыми валютами используемых центробанков (к примеру, USD-GBP).
5. Написать REST сервис где можно указать сумму и связку валют и получить в ответ сконвертированую сумму.
6. Написать интеграционные и юнит тесты.
7. Пришлите ссылку на репозитарий и укажите общее время, затраченное на задание.
8. Задание необходимо выполнить на фрэймворке Symfony последней версии (на текущий момент - 7).

Постарайтесь как можно полнее показать ваши знания и умения проектирования и написания кода.

## Установка

- Выкачать проект
- В корне проекта запустить команду `make setup`

## Документация

### 1. Архитектура и основные классы
- **1.1. Структура проекта**:
  - **Entity/Value Object**:
    - **CurrencyRate:** Сущность, представляющая курс валюты.
    - **CurrencyPair**: Value Object, представляющий связку валют (например, USD/GBP).
  - **Repository**:
    - **CurrencyRateRepository**: Репозиторий для работы с сущностью CurrencyRate. Содержит методы для сохранения и получения курсов валют из базы данных.
  - **Services**:
    - **CurrencyRateService**: Сервис для работы с курсами валют. Реализует логику обновления, конвертации валют, а также взаимодействие с внешними API.
    - **ExchangeRateCalculator**: Сервис для расчета обменных курсов между валютами, включая те, которые не являются базовыми для используемых центробанков.
    - **CurrencyDataProviderInterface**: Интерфейс, который определяет методы для получения курсов валют от различных поставщиков данных (например, ECB, CBR).
    - **ECBDataProvider, CBRDataProvider**: Конкретные реализации CurrencyDataProviderInterface для работы с ECB и CBR соответственно.
  - **DTO** (Data Transfer Object):
    - **ExchangeRequestDTO**: DTO для передачи данных о сумме и валютной паре в сервис конвертации.
    - **ExchangeResponseDTO**: DTO для возврата результата конвертации клиенту.
  - **Controllers**:
    - **CurrencyController**: Контроллер для обработки REST-запросов на конвертацию валют.
  - **Command**:
    - **UpdateCurrencyRatesCommand**: Symfony-команда для обновления курсов валют, которая вызывается раз в сутки через CRON.
- **1.2. Хранение данных**:
Для хранения данных о курсах валют будет использоваться сущность CurrencyRate, которая будет сохраняться в базе данных посредством Doctrine ORM.

### 2. Реализация функциональности
- **2.1. Консольная команда для обновления курсов**
 - Команда UpdateCurrencyRatesCommand будет отвечать за обновление курсов валют раз в сутки. Команда будет вызывать CurrencyRateService, который, в свою очередь, будет использовать CurrencyDataProvider для получения актуальных данных о курсах.
- **2.2. Получение данных с разных источников**
  - Для получения курсов валют из разных источников (ECB, CBR) будут использоваться классы ECBDataProvider и CBRDataProvider, которые реализуют интерфейс CurrencyDataProviderInterface. Выбор источника данных будет осуществляться на основе конфигурации.
- **2.3. Конвертация валют**
  - Для конвертации валют будет использоваться сервис ExchangeRateCalculator, который принимает на вход CurrencyPair и сумму, и возвращает конвертированное значение.
- **2.4. REST API для конвертации валют**
  - Контроллер CurrencyController будет обрабатывать запросы на конвертацию валют. Он будет принимать ExchangeRequestDTO, передавать его в ExchangeRateCalculator, и возвращать ExchangeResponseDTO в виде JSON.

### 3. Тестирование
Для тестирования будут написаны:
  - Юнит-тесты: Для проверки отдельных компонентов, таких как CurrencyRateService, ECBDataProvider, CBRDataProvider, и ExchangeRateCalculator.
  - Интеграционные тесты: Для проверки работы всего сервиса целиком, включая API.

### 4. Настройки и конфигурация
Конфигурация источников данных будет управляться через .env файл или config файлы Symfony. Например, CURRENCY_DATA_PROVIDER=ECB.

### 5. Итоги и оценки
   После реализации все классы будут задокументированы и покрыты тестами. Оценка времени на выполнение задачи: примерно 15-20 часов.

Таким образом, структура проекта будет четко разделена на модули, что позволит легко расширять функциональность и поддерживать код в будущем.
